rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // trees 컬렉션
    match /trees/{treeId} {
      // 누구나 트리 정보 읽기 가능 (방문자)
      allow read: if true;
      
      // 트리 생성: 필수 필드가 있으면 허용
      allow create: if request.resource.data.selectedTreeId != null
                    && request.resource.data.selectedBackgroundId != null
                    && request.resource.data.secretKey != null;
      
      // 트리 수정: 아이콘 추가 등 허용
      allow update: if true;
      
      // 삭제는 비허용
      allow delete: if false;
    }
  }
}